# Hunting-Queries-Detection-Rules
KQL Detections for Microsoft Sentinel and Microsoft 365 Defender

# KQL for Defender For Endpoint & Microsoft Sentinel
The purpose of this repository is to share KQL queries that can be used by anyone and are understandable. These queries are intended to increase detection coverage through the logs of Microsoft Security products. Not all suspicious activities generate an alert by default, but many of those activities can be made detectable through the logs. These queries include Detection Rules, Hunting Queries and Visualisations. Anyone is free to use the queries. If you have any questions feel free to reach out to me on twitter [@castello_johnny](https://twitter.com/castello_johnny). 

**Presenting this material as your own is illegal and forbidden. A reference to Twitter [@castello_johnny](https://twitter.com/castello_johnny) or Github [KustoKing](https://github.com/KustoKing/Hunting-Queries-Detection-Rules) is much appriciated when sharing or using the content.**

# Credits

[@castello_johnny](https://twitter.com/castello_johnny) - The content structure of this repository was adopted from [KustoKings's KQL repository](https://github.com/KustoKing/Hunting-Queries-Detection-Rules)

KQL Queries: While I have personally authored the majority of the KQL queries stored here, it is important to note that as I continue to collect queries in my daily work, the repository may also include KQL code contributed by others. I make every effort to acknowledge and credit the original creators whenever I have information about them.

In addition to the queries I have written myself, it's worth mentioning that certain queries within the repository may be direct copies of those found in Microsoft's online documentation and blog posts.

# KQL Categories

The queries in this repository are split into different categories. The MITRE ATT&CK category contains a list of queries mapped to the tactics of the MITRE Framwork. The product section contains queries specific to Microsoft security products. 

## Products

- [Active Directory](./Active%20Directory/)
- [Microsoft 365 Defender](./Microsoft%20365%20Defender/)
- [Microsoft 365 Defender For Endpoint](./Microsoft%20365%20Defender%20For%20Endpoint/)
- [Microsoft 365 Defender For Identity](./Microsoft%20365%20Defender%20For%20Identity)
- [Microsoft 365 Defender For Cloud Apps](./Microsoft%20365%20Defender%20For%20Cloud%20Apps)
- [Microsoft 365 Defender For Office 365](./Microsoft%20365%20Defender%20For%20Office%20365/)
- [Microosft 365 Defender External Attack Surface Management](./Microsoft%20365%20Defender%20External%20Attack%20Surface%20Management/)
- [Microsoft Entra ID](./Microsoft%20Entra%20ID)
- [Microsoft Sentinel](./Microsoft%20Sentinel)
